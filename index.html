<!-- Create a map using Leaflet, find and add some tile layers to the map. -->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Leaflet</title>
    <!-- leaflet css -->
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
      integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
      crossorigin=""
    />
    <!-- 手写狂草风格（近似） -->
    <link
      href="https://fonts.googleapis.com/css2?family=Zhi+Mang+Xing&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        margin: 0;
        padding: 0;
      }
      /* banner 主体与分割 */
      .banner {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 120px;
        color: #013a3a;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 20px;
        font-weight: 700;
        z-index: 1000;
        background-image: linear-gradient(
            rgba(255, 255, 255, 0.28),
            rgba(255, 255, 255, 0.12)
          ),
          url("https://images.unsplash.com/photo-1501785888041-af3ef285b470?auto=format&fit=crop&w=1400&q=80");
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
        text-shadow: 0 1px 2px rgba(255, 255, 255, 0.6);
      }
      .banner .banner-content {
        z-index: 1010;
        font-family: "Zhi Mang Xing", "STXingkai", "KaiTi", serif;
        font-size: 64px; /* 更大字体 */
        letter-spacing: 0.14em; /* 字符间距更大，视觉更疏朗 */
        color: #c68b2e; /* 暖金色，和风景图形成清新对比 */
        padding: 0 12px;
        line-height: 1;
        background: none; /* 保持无底色 */
        box-shadow: none;
        backdrop-filter: none;
        text-shadow: 0 2px 6px rgba(0, 0, 0, 0.22); /* 深色投影增强可读性 */
      }
      /* （已移除波形分割：保持原 banner 样式不变） */

      /* 立体感分割条（不改 banner） */
      .map-divider {
        position: fixed;
        top: 120px; /* 紧贴 banner 底部（banner 高度为 120px） */
        left: 0;
        width: 100%;
        height: 6px; /* 分割条高度，可按需微调 */
        z-index: 1001;
        pointer-events: none;
        /* 底色 + 轻微阴影，打造柔和立体感 */
        background: linear-gradient(
          180deg,
          rgba(255, 255, 255, 0.95) 0%,
          rgba(245, 250, 247, 0.95) 45%,
          rgba(225, 235, 225, 1) 100%
        );
        box-shadow: 0 6px 18px rgba(0, 0, 0, 0.08),
          inset 0 1px 0 rgba(255, 255, 255, 0.6);
      }
      /* 顶部高光与底部细线，增强分割层次 */
      .map-divider::before {
        content: "";
        position: absolute;
        left: 0;
        right: 0;
        top: 1px;
        height: 4px;
        background: linear-gradient(
          180deg,
          rgba(107, 109, 126, 0.9),
          rgba(72, 63, 152, 0)
        );
        pointer-events: none;
      }
      .map-divider::after {
        content: "";
        position: absolute;
        left: 0;
        right: 0;
        bottom: 0;
        height: 1px;
        background: rgba(0, 0, 0, 0.06);
        pointer-events: none;
      }

      /* 为 banner 留出空间 */
      #map {
        width: 100vw;
        height: calc(100vh - 132px); /* 考虑分割条高度（120 + 12） */
        margin-top: 132px;
      }
      .coordinate {
        position: absolute;
        bottom: 20px;
        right: 50%;
        background-color: antiquewhite;
      }
      /* 已恢复 Leaflet 控件的默认视觉与位置（移除自定义浮层样式与偏移） */

      .leaflet-popup-content-wrapper {
        background-color: rgb(205, 214, 206);
        color: #dc3030;
        border: 1px solid #dc3030;
        border-radius: 10px;
      }
      /* 已移除 map-separator 分割条 */
    </style>
  </head>
  <div></div>
  <body>
    <!-- Banner -->
    <header class="banner">
      <div class="banner-content">泊孤舟•忆旧游</div>
      <div class="banner-divider" aria-hidden="true">
        <!-- 简洁的 SVG 波形分割，颜色使用半透明白以与背景柔和过渡 -->
        <svg
          viewBox="0 0 1440 100"
          preserveAspectRatio="none"
          xmlns="http://www.w3.org/2000/svg"
          aria-hidden="true"
        >
          <path
            d="M0,60 C240,10 360,10 720,60 C1080,110 1200,110 1440,60 L1440,100 L0,100 Z"
            fill="rgba(255,255,255,0.92)"
          />
        </svg>
      </div>
    </header>
    <!-- 立体感分割条：独立于 banner，视觉上位于 banner 与地图之间 -->
    <div class="map-divider" aria-hidden="true"></div>
    <div id="map">
      <div class="leaflet-control coordinate"></div>
    </div>
    <script src="index.js"></script>
  </body>
</html>
<!-- leaflet js -->
<script
  src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
  integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
  crossorigin=""
></script>

<script src="./data/point.js"></script>
<script src="./data/line.js"></script>
<script src="./data/polygon.js"></script>

<script>
  /* *********************************************
                   Map initialization
  ********************************************** */
  // Map initialization
  var map = L.map("map").setView([30.25, 120.166664], 13);
  //   *********************************************
  //                          Tile Layer
  //   **********************************************

  // WMS Tile Layer
  var nexrad = L.tileLayer.wms(
    "http://mesonet.agron.iastate.edu/cgi-bin/wms/nexrad/n0r.cgi",
    {
      layers: "nexrad-n0r-900913",
      format: "image/png",
      transparent: true,
      attribution: "Weather data © 2012 IEM Nexrad",
    }
  );
  var osm = L.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png", {
    attribution:
      '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
  });
  //   osm.addTo(map);

  //watercolor
  var watercolor = L.tileLayer(
    "https://tiles.stadiamaps.com/tiles/stamen_watercolor/{z}/{x}/{y}.{ext}",
    {
      minZoom: 1,
      maxZoom: 16,
      attribution:
        '&copy; <a href="https://www.stadiamaps.com/" target="_blank">Stadia Maps</a> &copy; <a href="https://www.stamen.com/" target="_blank">Stamen Design</a> &copy; <a href="https://openmaptiles.org/" target="_blank">OpenMapTiles</a> &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
      ext: "jpg",
    }
  );
  //   watercolor.addTo(map);

  //dark map
  var darkmap = L.tileLayer(
    "https://{s}.basemaps.cartocdn.com/dark_nolabels/{z}/{x}/{y}{r}.png",
    {
      attribution:
        '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
      subdomains: "abcd",
      maxZoom: 20,
    }
  );
  //   darkmap.addTo(map);

  //google map
  googleMap = googleStreets = L.tileLayer(
    "http://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}",
    {
      maxZoom: 20,
      subdomains: ["mt0", "mt1", "mt2", "mt3"],
    }
  );
  googleMap.addTo(map);
  //googleSat
  googleSat = L.tileLayer("http://{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}", {
    maxZoom: 20,
    subdomains: ["mt0", "mt1", "mt2", "mt3"],
  });
  //   googleSat.addTo(map);
  /* *********************************************
                   marker
  ********************************************** */
  //   L.marker([30.25, 120.166664]).addTo(map);
  var myIcon = L.icon({
    iconUrl: "img/red_marker.png",
    iconSize: [40, 40],
    iconAnchor: [22, 94],
  });

  var singleMarker = L.marker([30.25, 120.166664], {
    icon: myIcon,
    draggable: true,
    autoPan: false,
  });

  var secondMarker = L.marker([30.2, 120.16], {
    icon: myIcon,
    draggable: true,
    autoPan: false,
  });
  var popup = singleMarker.bindPopup(
    "This is Hangzhou!" + singleMarker.getLatLng()
  );
  popup.addTo(map);
  //   console.log(singleMarker.toGeoJSON());
  //   *********************************************
  //                           GeoJSON
  //   **********************************************

  var pointData = L.geoJson(pointJson).addTo(map);
  var lineData = L.geoJson(lineJson).addTo(map);
  var polygonData = L.geoJson(polygonJson, {
    onEachFeature: function (feature, layer) {
      layer.bindPopup("<b>Name: </b> " + feature.properties.name);
    },
    style: {
      fillColor: "#ff0000",
      fillOpacity: 0.5,
      color: "#c0c0c0",
    },
  }).addTo(map);
  /* *********************************************
                   Layer controller
  ********************************************** */

  var baseMaps = {
    OSM: osm,
    Watercolor: watercolor,
    DarkMap: darkmap,
    GoogleMap: googleMap,
    GoogleSat: googleSat,
  };

  var overlayMaps = {
    SingleMarker: singleMarker,
    SecondMarker: secondMarker,
    Point: pointData,
    Line: lineData,
    Polygon: polygonData,
    Nexrad: nexrad, //add WMS layer
  };

  //   map.removeLayer(singleMarker);

  L.control.layers(baseMaps, overlayMaps, { collapsed: false }).addTo(map);
  /* *********************************************
                   Leaflet Event
  ********************************************** */
  map.on("mouseover", function () {
    console.log("Your Mouse is over the map!");
  });

  map.on("mousemove", function (e) {
    document.getElementsByClassName("coordinate")[0].innerHTML =
      "lat:" + e.latlng.lat + " | " + "lng:" + e.latlng.lng;
    console.log("lat:" + e.latlng.lat + "lng:" + e.latlng.lng);
  });
</script>
